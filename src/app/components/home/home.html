<div class="main-container">
  <!-- Top bar -->
  <div class="folder-container">
    <button (click)="pickDirectory()" [disabled]="scanning()" class="button">
      {{ scanning() ? 'Reading…' : 'Choose Folder' }}
    </button>

    @if (pickedOriginFolderName()) {
    <div class="text-sm text-gray-600">
      Origin Folder: <strong>{{ pickedOriginFolderName() }}</strong>
    </div>
    }
  </div>

  <div class="sub-folder-container">
    Selected: <strong>{{ selectedCount() }}</strong> / {{ totalFiles() }}
    <span class="mx-2">•</span>
    <button type="button" class="button" (click)="selectAll()">Select all</button>
    <span class="mx-1">|</span>
    <button type="button" class="button" (click)="clearSelection()">Clear</button>
  </div>

  @if (errorMsg()) {
  <div class="p-3 rounded bg-red-50 text-red-700">
    {{ errorMsg() }}
  </div>
  }

  <!-- Tabela -->
  @if (files().length) {
  <table class="table-container">
    <thead>
      <tr class="table-header">
        <th class="text-left p-2 border-b">Arquivo</th>
        <span>|</span>
        <th class="text-left p-2 border-b">Modificado em</th>
        <span>|</span>
        <th class="text-left p-2 border-b">Last Saved By</th>
      </tr>
    </thead>
    <tbody>
      @for (f of files(); track f.name) {
      <tr class="table-items">
        <td>
          <input
            type="checkbox"
            [checked]="isSelected(f.name)"
            (change)="onRowToggle($event, f.name)"
          />
        </td>
        <td class="file-item">{{ f.name }}</td>
        <span class="space">|</span>
        <td class="file-item">{{ f.lastModified | date : 'short' }}</td>
        <span class="space">|</span>
        <td class="file-item">
          {{ f.lastSavedBy || '-' }}
        </td>
      </tr>
      }
    </tbody>
  </table>
  } @else if (pickedOriginFolderName() && !scanning()) {
  <p class="text-alert-table-container">
    Nenhum arquivo .xlsx disponível. É provável que não há relatórios novos no momento.
  </p>
  }

  <div class="flex items-center justify-between border rounded p-2">
    <div class="table-footer">
      <button (click)="sendFiles()" class="button button_animated"><span>Send</span></button>
      <span>|</span>
      <button (click)="discardFiles()" class="button button_animated"><span>Discard</span></button>
      @if (pickedDestinationFolderName()) {
    <div class="text-sm text-gray-600">
      Destination Folder: <strong>{{ pickedDestinationFolderName() }}</strong>
    </div>
    }
    </div>
  </div>
</div>
